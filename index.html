<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="site-title">CampusHub - College Community Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .card-hover { transition: transform 0.2s, box-shadow 0.2s; }
        .card-hover:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
    </style>
</head>
<body class="bg-gray-50 text-gray-900">
    <!-- Responsive Navigation -->
    <nav class="bg-white shadow-lg fixed w-full top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-4">
                    <img id="site-logo" src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/ccbfebeb-15c2-4942-96aa-81fe58cee694.png" alt="CampusHub logo" class="w-10 h-10 rounded-full border-2 border-blue-500">
                    <h1 id="nav-title" class="text-2xl font-bold text-blue-600">CampusHub</h1>
                </div>
                <button id="mobile-menu-toggle" class="md:hidden text-gray-700 focus:outline-none">
                    <ion-icon name="menu-outline" size="large"></ion-icon>
                </button>
                <div class="hidden md:flex visitor-nav space-x-4">
                    <button onclick="showSection('home-section')" class="text-gray-700 hover:text-blue-600 transition">Home</button>
                    <button onclick="showSection('gallery-section')" class="text-gray-700 hover:text-blue-600 transition">Gallery</button>
                    <button onclick="showSection('competitions-section')" class="text-gray-700 hover:text-blue-600 transition">Competitions</button>
                    <button onclick="showSection('winners-section')" class="text-gray-700 hover:text-blue-600 transition">Winners</button>
                    <button onclick="showSection('news-section')" class="text-gray-700 hover:text-blue-600 transition">News</button>
                    <button onclick="showSection('auth-section')" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-800 transition">Login</button>
                </div>
                <div class="hidden md:flex user-nav space-x-2 md:space-x-4 flex-wrap">
                    <button onclick="showSection('dashboard-section')" class="text-xs md:text-sm text-gray-700 hover:text-blue-600 transition">Dashboard</button>
                    <button onclick="showSection('upload-section')" class="text-xs md:text-sm text-gray-700 hover:text-blue-600 transition">Upload</button>
                    <button onclick="showSection('gallery-section')" class="text-xs md:text-sm text-gray-700 hover:text-blue-600 transition">Gallery</button>
                    <button onclick="showSection('profile-section')" class="text-xs md:text-sm text-gray-700 hover:text-blue-600 transition">Profile</button>
                    <button onclick="showSection('chat-section')" class="text-xs md:text-sm text-gray-700 hover:text-blue-600 transition hidden chat-access">Chat</button>
                    <button onclick="showSection('admin-section')" class="hidden admin-only text-xs md:text-sm text-gray-700 hover:text-blue-600 transition">Admin</button>
                    <button onclick="showSection('owner-edit-section')" class="hidden owner-only text-xs md:text-sm text-gray-700 hover:text-blue-600 transition">Owner Edit</button>
                    <button onclick="logout()" class="text-xs md:text-sm bg-gray-600 text-white px-2 md:px-4 py-1 md:py-2 rounded-lg hover:bg-gray-800 transition">Logout</button>
                    <span class="text-xs md:text-sm text-gray-700 hidden md:inline" id="user-welcome"></span>
                </div>
            </div>
            <!-- Mobile Menu -->
            <div id="mobile-menu" class="md:hidden hidden mt-4 space-y-2">
                <button onclick="showSection('home-section')" class="block w-full text-left text-gray-700 hover:text-blue-600 transition">Home</button>
                <button onclick="showSection('gallery-section')" class="block w-full text-left text-gray-700 hover:text-blue-600 transition">Gallery</button>
                <button onclick="showSection('competitions-section')" class="block w-full text-left text-gray-700 hover:text-blue-600 transition">Competitions</button>
                <button onclick="showSection('winners-section')" class="block w-full text-left text-gray-700 hover:text-blue-600 transition">Winners</button>
                <button onclick="showSection('news-section')" class="block w-full text-left text-gray-700 hover:text-blue-600 transition">News</button>
                <button onclick="showSection('auth-section')" class="block w-full text-left bg-blue-600 text-white px-4 py-2 rounded-lg">Login</button>
                <div class="hidden user-mobile-nav space-y-2">
                    <button onclick="showSection('dashboard-section')" class="block w-full text-left text-gray-700 hover:text-blue-600">Dashboard</button>
                    <button onclick="showSection('upload-section')" class="block w-full text-left text-gray-700 hover:text-blue-600">Upload</button>
                    <button onclick="showSection('profile-section')" class="block w-full text-left text-gray-700 hover:text-blue-600">Profile</button>
                    <button onclick="showSection('chat-section')" class="chat-access block w-full text-left text-gray-700 hover:text-blue-600">Chat</button>
                    <button onclick="showSection('admin-section')" class="admin-only block w-full text-left text-gray-700 hover:text-blue-600">Admin</button>
                    <button onclick="showSection('owner-edit-section')" class="owner-only block w-full text-left text-gray-700 hover:text-blue-600">Owner Edit</button>
                    <button onclick="logout()" class="block w-full text-left bg-gray-600 text-white px-4 py-2 rounded-lg">Logout</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Home Section -->
    <section id="home-section" class="pt-20 pb-16 fade-in">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <img id="hero-image" src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/b4b25147-5b29-4ea3-9226-cabca36a062d.png" alt="Hero image" class="mx-auto mb-8 rounded-lg shadow-2xl w-full max-w-4xl">
            <h2 id="hero-title" class="text-4xl md:text-6xl font-bold mb-4">Welcome to CampusHub</h2>
            <p id="hero-description" class="text-xl mb-8">Your Ultimate Platform for College Communities, Competitions, and Creations</p>
            <button onclick="getStarted()" class="bg-blue-600 text-white px-8 py-4 rounded-lg font-semibold hover:bg-blue-800 transition duration-300 shadow-lg">Get Started</button>
        </div>
    </section>

    <!-- Auth Section -->
    <section id="auth-section" class="max-w-md mx-auto mt-10 bg-white p-8 rounded-xl shadow-xl hidden fade-in">
        <div id="login-form" class="space-y-4">
            <h3 class="text-3xl font-semibold mb-6 text-center">Login</h3>
            <input type="text" id="login-username" placeholder="Username" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
            <input type="password" id="login-password" placeholder="Password" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
            <button onclick="handleLogin()" class="w-full bg-blue-600 text-white p-3 rounded-lg hover:bg-blue-800 transition">Login</button>
            <p class="text-center mt-4 text-sm">New user? <a onclick="switchAuth()" href="#" class="text-blue-600 hover:underline">Register</a></p>
        </div>
        <div id="register-form" class="hidden space-y-4">
            <h3 class="text-3xl font-semibold mb-6 text-center">Register</h3>
            <input type="text" id="reg-username" placeholder="Username" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
            <input type="password" id="reg-password" placeholder="Password" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
            <select id="reg-role" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                <option value="student">Student</option>
                <option value="admin">Admin</option>
                <option value="owner">Owner</option>
            </select>
            <button onclick="handleRegister()" class="w-full bg-green-600 text-white p-3 rounded-lg hover:bg-green-900 transition">Register</button>
            <p class="text-center mt-4 text-sm">Have account? <a onclick="switchAuth()" href="#" class="text-blue-600 hover:underline">Login</a></p>
        </div>
    </section>

    <!-- Dashboard -->
    <section id="dashboard-section" class="max-w-7xl mx-auto mt-20 p-4 md:p-6 hidden fade-in">
        <h3 class="text-2xl md:text-3xl font-semibold mb-8 text-center">Dashboard</h3>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="bg-white p-6 rounded-lg shadow-lg card-hover text-center">
                <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/8444cd62-520d-49b4-bd45-ba79e56905b4.png" alt="Profile avatar" class="mx-auto mb-4 rounded-full border-4 border-blue-200">
                <h4 class="text-lg md:text-xl font-semibold">Welcome, <span id="dashboard-user"></span></h4>
                <p class="text-gray-600">Role: <span id="dashboard-role"></span></p>
            </div>
            <div class="bg-blue-50 p-6 rounded-lg shadow-lg">
                <h4 class="text-lg font-semibold mb-4"><ion-icon name="time-outline" class="mr-2"></ion-icon> Recent Activity</h4>
                <ul class="space-y-2 text-sm">
                    <li>‚Ä¢ Uploaded poster ‚Üí Pending approval</li>
                    <li>‚Ä¢ Voted in art contest</li>
                    <li>‚Ä¢ 3 notifications</li>
                </ul>
            </div>
            <div class="bg-green-50 p-6 rounded-lg shadow-lg">
                <h4 class="text-lg font-semibold mb-4"><ion-icon name="calendar-outline" class="mr-2"></ion-icon> Upcoming</h4>
                <ul class="space-y-2 text-sm">
                    <li>‚Ä¢ Photography Contest - Submit by Feb 15</li>
                    <li>‚Ä¢ Tech Talk - Jan 20</li>
                    <li>‚Ä¢ Exhibition - Jan 25</li>
                </ul>
            </div>
        </div>
        <div class="mt-8 text-center">
            <button onclick="showSection('gallery-section')" class="bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-800 transition">Explore</button>
        </div>
    </section>

    <!-- Gallery -->
    <section id="gallery-section" class="max-w-7xl mx-auto mt-20 p-4 md:p-6">
        <h3 class="text-2xl md:text-3xl font-semibold mb-8 text-center">Approved Gallery</h3>
        <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6" id="gallery-grid"></div>
        <div id="winner-section" class="mt-8 max-w-lg mx-auto bg-yellow-100 p-6 rounded-lg shadow-lg text-center hidden">
            <h4 class="text-xl md:text-2xl font-semibold">üèÜ Winner!</h4>
            <p>Student A</p>
        </div>
    </section>

    <!-- Competitions -->
    <section id="competitions-section" class="max-w-7xl mx-auto mt-20 p-4 md:p-6">
        <h3 class="text-3xl font-semibold mb-8 text-center">Active Competitions</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="competitions-grid">
            <div class="bg-blue-50 p-6 rounded-lg shadow-lg">
                <h4 class="font-semibold mb-2">Photography Contest</h4>
                <p class="text-sm mb-4">Submit by Feb 15</p>
                <button onclick="voteCompetition(1)" class="bg-blue-600 text-white px-4 py-2 rounded">Vote</button>
            </div>
        </div>
    </section>

    <!-- Winners -->
    <section id="winners-section" class="max-w-7xl mx-auto mt-20 p-4 md:p-6">
        <h3 class="text-3xl font-semibold mb-8 text-center">Hall of Fame</h3>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6" id="winners-grid">
            <div class="bg-yellow-100 p-6 rounded-lg shadow-lg text-center">
                <h4 class="font-semibold">2023 Art Contest</h4>
                <p>Winner: Student A</p>
                <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/904019f8-0ceb-4006-9c4d-e540171a5479.png" alt="Winner image" class="mt-2 rounded">
            </div>
        </div>
    </section>

    <!-- Profile -->
    <section id="profile-section" class="max-w-md mx-auto mt-20 bg-white p-8 rounded-xl shadow-xl hidden fade-in">
        <h3 class="text-3xl font-semibold mb-6 text-center">Your Profile</h3>
        <div class="space-y-4">
            <input type="text" id="profile-username" placeholder="Username" class="w-full p-3 border rounded" readonly>
            <input type="email" id="profile-email" placeholder="Email" class="w-full p-3 border rounded">
            <select id="profile-class" class="w-full p-3 border rounded">
                <option>Engineering</option>
                <option>Arts</option>
                <option>Science</option>
            </select>
            <textarea id="profile-bio" placeholder="Bio" rows="3" class="w-full p-3 border rounded"></textarea>
            <button onclick="updateProfile()" class="w-full bg-blue-600 text-white p-3 rounded hover:bg-blue-800">Update</button>
        </div>
    </section>

    <!-- Upload -->
    <section id="upload-section" class="max-w-lg mx-auto mt-20 bg-white p-8 rounded-xl shadow-xl hidden fade-in">
        <h3 class="text-3xl font-semibold mb-6 text-center">Upload Creation</h3>
        <form id="upload-form" class="space-y-4">
            <input type="file" id="upload-file" required class="w-full p-3 border rounded">
            <textarea id="upload-desc" placeholder="Description" rows="3" class="w-full p-3 border rounded"></textarea>
            <select id="upload-category" class="w-full p-3 border rounded">
                <option value="art">Art</option>
                <option value="photo">Photography</option>
                <option value="video">Video</option>
            </select>
            <button type="submit" class="w-full bg-purple-600 text-white p-3 rounded hover:bg-purple-900">Upload</button>
        </form>
        <div id="upload-status" class="mt-4 text-center text-sm hidden">
            <p id="upload-msg">Uploaded!</p>
        </div>
    </section>

    <!-- Chat (Simulated) -->
    <section id="chat-section" class="max-w-lg mx-auto mt-20 bg-white p-8 rounded-xl shadow-xl hidden fade-in">
        <h3 class="text-3xl font-semibold mb-6 text-center">Campus Chat</h3>
        <div id="chat-messages" class="h-64 overflow-y-scroll border p-4 mb-4">
            <p>Welcome to Campus Chat! (Simulated)</p>
        </div>
        <input type="text" id="chat-input" placeholder="Type a message" class="w-full p-3 border rounded">
        <button onclick="sendMessage()" class="mt-2 bg-blue-600 text-white px-4 py-2 rounded">Send</button>
    </section>

    <!-- Admin Panel -->
    <section id="admin-section" class="max-w-7xl mx-auto mt-20 bg-white p-8 rounded-xl shadow-xl hidden fade-in">
        <h3 class="text-3xl font-semibold mb-6">Admin Panel</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
                <h4 class="text-xl font-semibold mb-4">Pending Uploads</h4>
                <div id="pending-uploads"></div>
                <button onclick="approveAll()" class="mt-4 bg-blue-600 text-white px-4 py-2 rounded">Approve All</button>
            </div>
            <div>
                <h4 class="text-xl font-semibold mb-4">Competitions</h4>
                <input type="text" id="new-comp-name" placeholder="Name" class="p-2 border rounded w-full mb-2">
                <button onclick="createCompetition()" class="bg-green-600 text-white px-4 py-2 rounded">Create</button>
                <div id="competitions-list" class="mt-4"></div>
            </div>
        </div>
    </section>

    <!-- Owner Edit Panel -->
    <section id="owner-edit-section" class="max-w-6xl mx-auto mt-20 bg-white p-8 rounded-xl shadow-xl hidden fade-in">
        <h3 class="text-3xl font-semibold mb-6 text-center">Owner Customization</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
                <label class="block text-sm font-medium mb-2">Logo URL</label>
                <input type="url" id="edit-logo-url" class="w-full p-3 border rounded">
            </div>
            <div>
                <label class="block text-sm font-medium mb-2">Site Title</label>
                <input type="text" id="edit-site-title" class="w-full p-3 border rounded">
            </div>
            <div>
                <label class="block text-sm font-medium mb-2">Hero Title</label>
                <input type="text" id="edit-hero-title" class="w-full p-3 border rounded">
            </div>
            <div>
                <label class="block text-sm font-medium mb-2">Hero Description</label>
                <textarea id="edit-hero-description" rows="3" class="w-full p-3 border rounded"></textarea>
            </div>
        </div>
        <div class="mt-6 text-center">
            <button onclick="saveEditingChanges()" class="bg-blue-600 text-white px-6 py-3 rounded hover:bg-blue-800">Save</button>
            <button onclick="resetToDefault()" class="ml-4 bg-gray-600 text-white px-6 py-3 rounded hover:bg-gray-800">Reset</button>
        </div>
    </section>

    <!-- News & Events -->
    <section id="news-section" class="max-w-6xl mx-auto mt-20 p-4 md:p-6">
        <h3 class="text-3xl font-semibold mb-8 text-center">News & Announcements</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <div class="bg-white p-6 rounded-lg shadow-lg card-hover">
                <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/3f99ae3a-1751-4923-a3e9-43490bd5a328.png" alt="News image 1" class="w-full h-32 object-cover rounded mb-4">
                <h4 class="font-semibold mb-2">New Competition</h4>
                <p class="text-sm">Join the photography contest!</p>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-lg card-hover">
                <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/15ad5761-de20-4516-ae1d-41c802087836.png" alt="News image 2" class="w-full h-32 object-cover rounded mb-4">
                <h4 class="font-semibold mb-2">Tech Talk</h4>
                <p class="text-sm">AI trends workshop coming up.</p>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-lg card-hover md:col-span-2 lg:col-span-1">
                <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/9283f432-0a54-41ba-b7dd-3d01c2143097.png" alt="News image 3" class="w-full h-32 object-cover rounded mb-4">
                <h4 class="font-semibold mb-2">Art Exhibition</h4>
                <p class="text-sm">Winners revealed!</p>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white mt-20 py-12">
        <div class="max-w-7xl mx-auto px-4 grid grid-cols-1 md:grid-cols-4 gap-8">
            <div>
                <img id="footer-logo" src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/1bdabea8-25d8-43fa-a7ee-be82bfdbcd8d.png" alt="Footer logo" class="mb-4 rounded">
                <p id="footer-tagline" class="text-sm">Building communities since 2023</p>
            </div>
            <div>
                <h4 class="font-semibold mb-4">Quick Links</h4>
                <ul class="space-y-2 text-sm">
                    <li><button onclick="showSection('gallery-section')" class="hover:underline">Gallery</button></li>
                    <li><button onclick="showSection('competitions-section')" class="hover:underline">Competitions</button></li>
                    <li><button onclick="showSection('winners-section')" class="hover:underline">Winners</button></li>
                </ul>
            </div>
            <div>
                <h4 class="font-semibold mb-4">Support</h4>
                <ul class="space-y-2 text-sm">
                    <li><button onclick="showSection('news-section')" class="hover:underline">Help</button></li>
                    <li><button onclick="showSection('chat-section')" class="hover:underline">Chat</button></li>
                    <li><a href="#" class="hover:underline">Terms</a></li>
                </ul>
            </div>
            <div>
                <h4 class="font-semibold mb-4">Contact</h4>
                <p class="text-sm">Email: campus@hub.edu</p>
                <img id="contact-image" src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/8f888c83-41b6-489a-8083-886613e0dff4.png" alt="Contact image" class="mt-2 rounded">
            </div>
        </div>
        <div class="text-center mt-8 border-t border-gray-700 pt-8">
            <p>¬© 2023 CampusHub. All rights reserved.</p>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        // ... (rest of JavaScript code with updates for new features)
        let currentUser = null;
        let uploads = [];
        let competitions = [];
        let votes = {};
        const winners = ['Student A', 'Student B'];

        // Initialize on load
        window.onload = () => {
            loadData();
            showSection('home-section');
            updateUI();
        };

        function loadData() {
            currentUser = JSON.parse(localStorage.getItem('currentUser'));
            uploads = JSON.parse(localStorage.getItem('uploads')) || [];
            competitions = JSON.parse(localStorage.getItem('competitions')) || [];
            votes = JSON.parse(localStorage.getItem('votes')) || {};
            users = JSON.parse(localStorage.getItem('users')) || [];
        }

        function saveData() {
            localStorage.setItem('uploads', JSON.stringify(uploads));
            localStorage.setItem('competitions', JSON.stringify(competitions));
            localStorage.setItem('votes', JSON.stringify(votes));
        }

        function showSection(sectionId) {
            document.querySelectorAll('section').forEach(s => s.classList.add('hidden'));
            document.getElementById(sectionId).classList.remove('hidden');
            if (sectionId === 'gallery-section') loadGallery();
            if (sectionId === 'profile-section') loadProfile();
        }

        function updateUI() {
            if (currentUser) {
                document.querySelector('.visitor-nav').classList.add('hidden');
                document.querySelector('.user-nav').classList.remove('hidden');
                document.querySelector('.user-mobile-nav').classList.remove('hidden');
                document.getElementById('user-welcome').textContent = `Hi, ${currentUser.username}`;
                if (currentUser.role === 'student') {
                    document.querySelectorAll('.chat-access').forEach(el => el.classList.remove('hidden'));
                }
                if (currentUser.role === 'admin' || currentUser.role === 'owner') {
                    document.querySelectorAll('.admin-only').forEach(el => el.classList.remove('hidden'));
                }
                if (currentUser.role === 'owner') {
                    document.querySelectorAll('.owner-only').forEach(el => el.classList.remove('hidden'));
                }
            } else {
                document.querySelector('.visitor-nav').classList.remove('hidden');
                document.querySelector('.user-nav').classList.add('hidden');
                document.querySelector('.user-mobile-nav').classList.add('hidden');
            }
        }

        function handleLogin() {
            const username = document.getElementById('login-username').value;
            const password = document.getElementById('login-password').value;
            const user = users.find(u => u.username === username && u.password === password);
            if (user) {
                currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                updateUI();
                note('Login successful!');
                showSection('dashboard-section');
            } else {
                note('Invalid credentials');
            }
        }

        function handleRegister() {
            const username = document.getElementById('reg-username').value;
            const password = document.getElementById('reg-password').value;
            const role = document.getElementById('reg-role').value;
            if (users.find(u => u.username === username)) {
                note('Username exists');
                return;
            }
            const newUser = { username, password, role };
            users.push(newUser);
            currentUser = newUser;
            localStorage.setItem('users', JSON.stringify(users));
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            updateUI();
            note('Registered!');
            showSection('dashboard-section');
        }

        function switchAuth() {
            document.getElementById('login-form').classList.toggle('hidden');
            document.getElementById('register-form').classList.toggle('hidden');
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            updateUI();
            showSection('home-section');
            note('Logged out');
        }

        function getStarted() {
            showSection(currentUser ? 'dashboard-section' : 'auth-section');
        }

        function loadGallery() {
            const grid = document.getElementById('gallery-grid');
            grid.innerHTML = uploads.filter(u => u.approved).map(upload => `
                <div class="bg-white p-4 rounded-lg shadow-lg card-hover">
                    <img src="https://placehold.co/300x200/e5e7eb/2563eb?text=${upload.filename}" alt="${upload.description}" class="w-full h-48 object-cover rounded-lg">
                    <h5 class="font-semibold mt-2">${upload.filename}</h5>
                    <p class="text-sm text-gray-600">By: ${upload.student}</p>
                    <p class="text-xs mb-2">${upload.description}</p>
                    <button onclick="vote(${upload.id})" class="bg-green-500 text-white px-3 py-1 rounded text-sm">Vote</button>
                </div>
            `).join('');
        }

        function vote(id) {
            if (!currentUser) {
                note('Login to vote');
                return;
            }
            if (!votes[currentUser.username]) votes[currentUser.username] = {};
            votes[currentUser.username][id] = true;
            saveData();
            note('Vote cast!');
        }

        function voteCompetition(id) {
            // Implement voting for competitions
            note('Competition vote registered!');
        }

        function sendMessage() {
            const msg = document.getElementById('chat-input').value;
            if (msg.trim()) {
                const messages = document.getElementById('chat-messages');
                messages.innerHTML += `<p><strong>${currentUser.username}:</strong> ${msg}</p>`;
                document.getElementById('chat-input').value = '';
            }
        }

        function updateProfile() {
            // Implement profile update logic
            note('Profile updated!');
        }

        function createCompetition() {
            const name = document.getElementById('new-comp-name').value;
            if (name) {
                competitions.push({ name, active: true });
                loadCompetitions();
                note('Competition created!');
                saveData();
            }
        }

        // Mobile menu toggle
        document.getElementById('mobile-menu-toggle').addEventListener('click', () => {
            document.getElementById('mobile-menu').classList.toggle('hidden');
        });

        function note(msg) {
            alert(msg); // In a real app, use toast notifications
        }
    </script>
</body>
</html>
